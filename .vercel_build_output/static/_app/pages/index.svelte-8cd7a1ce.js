import{S as G,i as W,s as X,e as T,k as N,c as R,a as j,m as O,d as g,b as l,L as Y,g as S,J as _,M as L,N as J,K,O as Z,w as x,x as $,y as ee,q as B,o as C,B as te,t as oe,P as se,h as ae,p as le,Q as ne,n as re}from"../chunks/vendor-c602e39a.js";const V=(o,{result:e})=>{const s=async t=>{t.preventDefault();try{const r=new FormData(o),c=await fetch(o.action,{method:o.method,headers:{accept:"application/json"},body:r});c.ok?e(c,o):console.error("Fetch error: ",await c.text())}catch(r){console.error("Could not submit the form: ",r)}};return o.addEventListener("submit",s),{destroy(){o.removeEventListener("submit",s)}}};function ue(o){let e,s,t,r,c,i,u,f,w,m,b,U,E,d,M,n,h,a,y,k,D,P,A;return{c(){e=T("div"),s=T("form"),t=T("input"),c=N(),i=T("button"),w=N(),m=T("form"),b=T("input"),E=N(),d=T("button"),h=N(),a=T("form"),y=T("button"),this.h()},l(v){e=R(v,"DIV",{class:!0});var p=j(e);s=R(p,"FORM",{action:!0,method:!0});var q=j(s);t=R(q,"INPUT",{type:!0,name:!0,class:!0}),c=O(q),i=R(q,"BUTTON",{"aria-label":!0,class:!0}),j(i).forEach(g),q.forEach(g),w=O(p),m=R(p,"FORM",{action:!0,method:!0,class:!0});var F=j(m);b=R(F,"INPUT",{type:!0,name:!0,class:!0}),E=O(F),d=R(F,"BUTTON",{"aria-label":!0,class:!0}),j(d).forEach(g),F.forEach(g),h=O(p),a=R(p,"FORM",{action:!0,method:!0});var H=j(a);y=R(H,"BUTTON",{"aria-label":!0,class:!0}),j(y).forEach(g),H.forEach(g),p.forEach(g),this.h()},h(){l(t,"type","hidden"),l(t,"name","done"),t.value=r=o[0].done?"":"true",l(t,"class","svelte-7gbs8g"),l(i,"aria-label",u="Mark todo as "+(o[0].done?"not done":"done")),l(i,"class","toggle svelte-7gbs8g"),l(s,"action",f="/todos/"+o[0].uid+".json?_method=patch"),l(s,"method","post"),l(b,"type","text"),l(b,"name","text"),b.value=U=o[0].text,l(b,"class","svelte-7gbs8g"),l(d,"aria-label","Save todo"),l(d,"class","save svelte-7gbs8g"),l(m,"action",M="/todos/"+o[0].uid+".json?_method=patch"),l(m,"method","post"),l(m,"class","text svelte-7gbs8g"),l(y,"aria-label","Delete todo"),l(y,"class","delete svelte-7gbs8g"),l(a,"action",k="/todos/"+o[0].uid+".json?_method=delete"),l(a,"method","post"),l(e,"class","todo svelte-7gbs8g"),Y(e,"done",o[3])},m(v,p){S(v,e,p),_(e,s),_(s,t),_(s,c),_(s,i),_(e,w),_(e,m),_(m,b),_(m,E),_(m,d),_(e,h),_(e,a),_(a,y),P||(A=[L(n=V.call(null,m,{result:o[2]})),L(D=V.call(null,a,{result:o[1]}))],P=!0)},p(v,[p]){p&1&&r!==(r=v[0].done?"":"true")&&(t.value=r),p&1&&u!==(u="Mark todo as "+(v[0].done?"not done":"done"))&&l(i,"aria-label",u),p&1&&f!==(f="/todos/"+v[0].uid+".json?_method=patch")&&l(s,"action",f),p&1&&U!==(U=v[0].text)&&b.value!==U&&(b.value=U),p&1&&M!==(M="/todos/"+v[0].uid+".json?_method=patch")&&l(m,"action",M),n&&J(n.update)&&p&4&&n.update.call(null,{result:v[2]}),p&1&&k!==(k="/todos/"+v[0].uid+".json?_method=delete")&&l(a,"action",k),D&&J(D.update)&&p&2&&D.update.call(null,{result:v[1]})},i:K,o:K,d(v){v&&g(e),P=!1,Z(A)}}}function de(o,e,s){let{todo:t}=e;const r=t.done;let{processDeletedTodoResult:c}=e,{processUpdatedTodoResult:i}=e;return o.$$set=u=>{"todo"in u&&s(0,t=u.todo),"processDeletedTodoResult"in u&&s(1,c=u.processDeletedTodoResult),"processUpdatedTodoResult"in u&&s(2,i=u.processUpdatedTodoResult)},[t,c,i,r]}class ce extends G{constructor(e){super();W(this,e,de,ue,X,{todo:0,processDeletedTodoResult:1,processUpdatedTodoResult:2})}}function Q(o,e,s){const t=o.slice();return t[4]=e[s],t}function z(o){let e,s;function t(){return o[3](o[4])}return e=new ce({props:{todo:o[4],processDeletedTodoResult:t,processUpdatedTodoResult:o[2]}}),{c(){x(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,c){ee(e,r,c),s=!0},p(r,c){o=r;const i={};c&1&&(i.todo=o[4]),c&1&&(i.processDeletedTodoResult=t),e.$set(i)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){C(e.$$.fragment,r),s=!1},d(r){te(e,r)}}}function ie(o){let e,s,t,r,c,i,u,f,w,m,b,U;document.title=e=I;let E=o[0],d=[];for(let n=0;n<E.length;n+=1)d[n]=z(Q(o,E,n));const M=n=>C(d[n],1,1,()=>{d[n]=null});return{c(){s=N(),t=T("div"),r=T("h1"),c=oe(I),i=N(),u=T("form"),f=T("input"),w=N();for(let n=0;n<d.length;n+=1)d[n].c();this.h()},l(n){se('[data-svelte="svelte-1258swp"]',document.head).forEach(g),s=O(n),t=R(n,"DIV",{class:!0});var a=j(t);r=R(a,"H1",{});var y=j(r);c=ae(y,I),y.forEach(g),i=O(a),u=R(a,"FORM",{action:!0,method:!0,class:!0});var k=j(u);f=R(k,"INPUT",{type:!0,name:!0,"aria-label":!0,placeholder:!0,class:!0}),k.forEach(g),w=O(a);for(let D=0;D<d.length;D+=1)d[D].l(a);a.forEach(g),this.h()},h(){l(f,"type","text"),l(f,"name","text"),l(f,"aria-label","Add a todo"),l(f,"placeholder","+ tap to add a todo"),l(f,"class","svelte-1puqrhu"),l(u,"action","/todos.json"),l(u,"method","post"),l(u,"class","new svelte-1puqrhu"),l(t,"class","todos svelte-1puqrhu")},m(n,h){S(n,s,h),S(n,t,h),_(t,r),_(r,c),_(t,i),_(t,u),_(u,f),_(t,w);for(let a=0;a<d.length;a+=1)d[a].m(t,null);m=!0,b||(U=L(V.call(null,u,{result:o[1]})),b=!0)},p(n,[h]){if((!m||h&0)&&e!==(e=I)&&(document.title=e),h&5){E=n[0];let a;for(a=0;a<E.length;a+=1){const y=Q(n,E,a);d[a]?(d[a].p(y,h),B(d[a],1)):(d[a]=z(y),d[a].c(),B(d[a],1),d[a].m(t,null))}for(re(),a=E.length;a<d.length;a+=1)M(a);le()}},i(n){if(!m){for(let h=0;h<E.length;h+=1)B(d[h]);m=!0}},o(n){d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)C(d[h]);m=!1},d(n){n&&g(s),n&&g(t),ne(d,n),b=!1,U()}}}const me=async({fetch:o})=>{const e=await o("/todos.json");if(e.ok)return{props:{todos:await e.json()}};const{message:s}=await e.json();return{error:new Error(s)}},I="Todo";function fe(o,e,s){let{todos:t}=e;const r=async(u,f)=>{const w=await u.json();s(0,t=[...t,w]),f.reset()},c=async u=>{const f=await u.json();s(0,t=t.map(w=>w.uid===f.uid?f:w))},i=u=>{s(0,t=t.filter(f=>f.uid!==u.uid))};return o.$$set=u=>{"todos"in u&&s(0,t=u.todos)},[t,r,c,i]}class _e extends G{constructor(e){super();W(this,e,fe,ie,X,{todos:0})}}export{_e as default,me as load};
